---
import BaseNavigation from "../components/components/BaseNavigation.astro";
import BaseFooter from "../components/components/BaseFooter.astro";
import BaseHead from "../components/components/BaseHead.astro";
import type { BaseProps } from "../utils/types/props";
import "../styles/global.css";

type Props = BaseProps;

const {
	title,
	description,
	classList,
	pageTitle,
	ogImage,
	metaRobots = "index, follow",
} = Astro.props;
---

<html lang="en" class="h-full">
	<head>
		<BaseHead
			ogImage={ogImage}
			title={title}
			description={description}
			metaRobots={metaRobots}
		/>
	</head>

	<body class:list={[classList]}>
		<BaseNavigation {pageTitle} />
		<div class="page-background min-h-screen">
			<slot />
		</div>
		<BaseFooter />
		{
			import.meta.env.PROD && (
				<script async src="https://cdn.onthe.io/io.js/YyAMWtaLLPUi" />
			)
		}
		<script>
			import { useRandomColor } from "../composables/useRandomColor";
			const { getRandomColor } = useRandomColor();

			function updateBackgroundColor() {
				const isDark = document.documentElement.classList.contains("dark");
				const color = getRandomColor(isDark);
				const element = document.querySelector(
					".page-background",
				) as HTMLElement;
				if (element) {
					element.style.backgroundColor = color;
				}
			}

			// Initialisation immédiate
			updateBackgroundColor();

			// Mettre à jour la couleur au changement de thème uniquement
			window.addEventListener("theme-changed", updateBackgroundColor);
		</script>
	</body>
</html>
